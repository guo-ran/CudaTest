NVIDIA Apex提供了LayerNorm的高性能fuse版本实现，这里用OneFlow和Apex LayerNorm进行对比，Apex版本为：

测试用例： num_rows固定为49152, num_cols 由32-32768变化。

#### 性能表格前向：

**NVIDIA A100-PCIE-40GB** Kernel的执行时间，单位us，越小越好

|         | 32     | 64     | 128    | 256    | 512    | 1024   | 2048   | 4096   | 8192 | 16384 | 32768 |
| ------- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ---- | ----- | ----- |
| OneFlow | 17.12  | 29.41  | 57.22  | 66.5   | 93.41  | 154.56 | 329.95 | 938.72 | 1910 | 4660  | 7760  |
| Apex    | 188.19 | 191.04 | 195.46 | 206.27 | 252.19 | 349.73 | 541.89 | 1040   | 2630 | 5470  | 11090 |


#### 性能表格后向求dx：

**NVIDIA A100-PCIE-40GB** Kernel的执行时间，单位us，越小越好

|         | 32     | 64     | 128    | 256    | 512    | 1024   | 2048   | 4096 | 8192 | 16384 | 32768 |
| ------- | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ---- | ---- | ----- | ----- |
| OneFlow | 18.85  | 30.08  | 41.15  | 58.59  | 110.11 | 218.24 | 489.47 | 1070 | 3660 | 6120  | 13290 |
| Apex    | 125.54 | 129.98 | 139.71 | 172.29 | 243.14 | 400    | 827.62 | 1960 | 4160 | 8250  | 16600 |

#### TODO paramGrad性能对比

注：测试发现前向时cols=2048时用warp实现可以启动且性能比SharedMemory实现好很多，因此前向判断条件是<=2048
后向时cols=2048用warp实现启动不起来，后向判断条件是<=1024

测试代码在:[代码](../code/layer_norm/) 下
